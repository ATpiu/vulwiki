# Nginx文件解析漏洞

### 漏洞等级

高危

### 漏洞描述

nginx文件解析漏洞产生的原因是网站中间键版本过低，可将任意文件当作php可执行文件来执行，可导致攻击者执行恶意代码来控制服务器。

### 漏洞危害

- 机密数据被窃取；
- 核心业务数据被篡改；
- 网页被篡改；
- 数据库所在服务器被攻击变为傀儡主机，导致局域网(内网)被入侵。

### 修复方案

- 升级中间件版本
- 部署Web应用防火墙
- 对数据库操作进行监控
- 修改php.ini文件，将cgi.fix_pathinfo的值设置为0；
- 在Nginx配置文件中添加以下代码：

```
 if( $fastcgi_script_name
 ~ ..*/.*php 
 ) {return 403;}
```

这行代码的意思是当匹配到类似test.jpg/a.php的URL时，将返回403错误代码。