# DNS域传送漏洞

### 漏洞描述

网站DNS服务器配置不当，使得攻击者可获取DNS数据库的详细信息，导致所有域名DNS泄露，从而引起进一步的入侵。DNS主备之间的数据同步就会用到dns域传送，但如果配置不当，就会导致任何匿名用户都可以获取DNS服务器某一域的所有记录，将整个企业的基础业务以及网络架构对外暴露从而造成严重的信息泄露，甚至导致企业网络被渗透。

### 漏洞测试

如dns服务器IP：1.1.1.1 测试域名为wooyun.org，测试命令如下：

![img](https://nmask.gitbooks.io/vulnerability-box/assets/79C2DBD5-C1BE-4E3F-8F3D-C5BAF551CB5A.png)

### 漏洞危害

- 可导致攻击者获取DNS服务器某一域的所有记录，将整个单位的基础业务以及网络架构对外暴露从而造成严重的信息泄露，甚至导致内部网络被渗透；
- 攻击者可快速的判定出某个特定zone的所有主机，收集域信息，选择攻击目标，找出未使用的IP地址，攻击者可以绕过基于网络的访问控制。

### 修复方案

- 严格限制允许区域传送的主机，例如一个主DNS服务器应该只允许它的从DNS服务器执行区域传送的功能；
- 在相应的zone、options中添加allow-transfer限制可以进行同步的服务器，有两种方式：限制IP、使用key认证。优先级为如果zone没有进行配置，则遵守options的设置。如果zone进行了配置，则遵守zone的设置。